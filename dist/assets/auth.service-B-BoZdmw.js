import{c as t}from"./supabase-w99FfbcE.js";class u{static initialized=!1;static async init(){this.initialized||(await t.load(),this.initialized=!0)}static async signIn(e,i){if(await this.init(),!i)throw new Error("Password required for login");if(!t.client)throw new Error("Clerk client not initialized");const s=await t.client.signIn.create({identifier:e,password:i});if(s.status==="complete")return await t.setActive({session:s.createdSessionId}),t.user;throw console.error("SignIn status:",s.status),new Error("Login requires further verification. Please check your email.")}static async signUp(e,i,s){if(await this.init(),!i)throw new Error("Password required for signup");if(!t.client)throw new Error("Clerk client not initialized");const a=(s||"").trim().split(" "),n=a[0],o=a.slice(1).join(" ")||void 0;try{const r=await t.client.signUp.create({emailAddress:e,password:i,firstName:n,lastName:o});if(r.status==="complete")return await t.setActive({session:r.createdSessionId}),t.user;throw r.status==="missing_requirements"?(await r.prepareEmailAddressVerification({strategy:"email_code"}),new Error("VERIFICATION_REQUIRED")):new Error("Signup failed: "+r.status)}catch(r){throw r.errors&&r.errors.length>0?new Error(r.errors[0].message):r}}static async verifyEmail(e){if(await this.init(),!t.client)throw new Error("Clerk client not initialized");const i=await t.client.signUp.attemptEmailAddressVerification({code:e});if(i.status==="complete")return await t.setActive({session:i.createdSessionId}),t.user;throw new Error("Verification failed.")}static async getUser(){if(await this.init(),t.user)return t.user;const e=localStorage.getItem("guest_user");return e?JSON.parse(e):null}static async loginAsGuest(e){const i={id:"guest-"+Date.now(),email:e,firstName:"Guest",lastName:"",imageUrl:"",primaryEmailAddress:{emailAddress:e}};return localStorage.setItem("guest_user",JSON.stringify(i)),i}static async logout(){return await this.init(),localStorage.removeItem("guest_user"),t.signOut()}static async isAdmin(){return await this.init(),t.user?t.user.publicMetadata.role==="admin":!1}}export{u as A};
