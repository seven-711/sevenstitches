import"./supabase-w99FfbcE.js";/* empty css              */import{AppHeader as S}from"./header-BXuXbyNE.js";import{C as F}from"./category.service-ILwE1iue.js";import{P as C}from"./product.service-oboCqACv.js";import"./auth.service-B-BoZdmw.js";import"./toast-CErdx8Qf.js";customElements.define("app-header",S);console.log("Crochet Corner is live!");async function P(){const o=document.getElementById("landing-categories-container");if(o)try{const e=await F.getCategories();if(e.length===0){o.innerHTML='<div class="col-span-full text-center py-10 text-gray-500">No categories found.</div>';return}const u=await Promise.all(e.map(async l=>{let x=null;try{const b=await C.getProductsByCategory(l.name);if(b.length>0){const h=b[Math.floor(Math.random()*b.length)];x=h.images&&h.images.length>0?h.images[0]:null}}catch(b){console.warn(`Could not fetch product for category ${l.name}`,b)}return{...l,imageUrl:x}}));o.innerHTML=u.map(l=>`
         <a class="group flex flex-col gap-4 p-6 rounded-[2rem] bg-white dark:bg-[#2a201a] border border-[#e2e8f0] dark:border-[#1e293b] hover:border-primary/50 hover:shadow-lg transition-all text-center items-center"
            href="/pages/category.html?type=${l.name}">
            <div class="size-24 rounded-full bg-[#f8fafc] dark:bg-[#1e293b] overflow-hidden mb-2 group-hover:scale-110 transition-transform duration-300">
                ${l.imageUrl?`
                    <div class="w-full h-full bg-cover bg-center" style="background-image: url('${l.imageUrl}');"></div>
                `:`
                    <div class="w-full h-full bg-cover bg-center flex items-center justify-center bg-primary/10 text-primary">
                        <span class="material-symbols-outlined text-4xl">category</span>
                    </div>
                `}
            </div>
            <div>
                <h2 class="text-lg font-bold leading-tight">${l.name}</h2>
                <span class="text-xs text-gray-500 mt-1 block">${l.description||"Explore Collection"}</span>
            </div>
        </a>
        `).join("")}catch(e){console.error("Failed to load categories:",e),o.innerHTML='<div class="col-span-full text-center py-10 text-red-500">Failed to load categories.</div>'}}document.addEventListener("DOMContentLoaded",P);class T{static API_URL="http://localhost:3000/api/subscribe";static async subscribe(e){try{const u=await fetch(this.API_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})}),l=await u.json();return u.ok?{success:!0,message:"Thank you! Check your inbox for your code."}:{success:!1,message:l.error||"Subscription failed. Please try again."}}catch(u){return console.error("Newsletter Service Error:",u),{success:!1,message:"Connection error. Please check your internet."}}}static validateEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}}const s={default:{name:"default",colors:{primary:"text-primary",bg:"bg-primary",light:"bg-primary/10",border:"border-primary"}},green:{name:"green",colors:{primary:"text-green-600",bg:"bg-green-600",light:"bg-green-100",border:"border-green-600"}},pink:{name:"pink",colors:{primary:"text-pink-500",bg:"bg-pink-500",light:"bg-pink-100",border:"border-pink-500"}},purple:{name:"purple",colors:{primary:"text-purple-600",bg:"bg-purple-600",light:"bg-purple-100",border:"border-purple-600"}},red:{name:"red",colors:{primary:"text-red-600",bg:"bg-red-600",light:"bg-red-100",border:"border-red-600"}},cream:{name:"cream",colors:{primary:"text-[#FEEAC9]",bg:"bg-[#FEEAC9]",light:"bg-[#FEEAC9]/50",border:"border-[#FEEAC9]"}},coral:{name:"coral",colors:{primary:"text-[#FD7979]",bg:"bg-[#FD7979]",light:"bg-[#FD7979]/50",border:"border-[#FD7979]"}},yellow:{name:"yellow",colors:{primary:"text-yellow-600",bg:"bg-yellow-600",light:"bg-yellow-100",border:"border-yellow-600"}}};function M(o){if(o.theme_color){if(o.theme_color==="green")return s.green;if(o.theme_color==="pink")return s.pink;if(o.theme_color==="purple")return s.purple;if(o.theme_color==="red")return s.red;if(o.theme_color==="cream")return s.cream;if(o.theme_color==="coral")return s.coral;if(o.theme_color==="yellow")return s.yellow;if(o.theme_color==="blue")return s.default}const e=o.name.toLowerCase();return e.includes("hexagon")||e.includes("green")||e.includes("plant")?s.green:e.includes("bear")||e.includes("pink")||e.includes("love")?s.pink:e.includes("flower")||e.includes("tangled")||e.includes("purple")?s.purple:e.includes("apple")||e.includes("red")||e.includes("fire")?s.red:e.includes("vanilla")||e.includes("cream")||e.includes("beige")?s.cream:e.includes("coral")||e.includes("reef")||e.includes("salmon")?s.coral:e.includes("yellow")||e.includes("sun")||e.includes("gold")||e.includes("bee")?s.yellow:s.default}async function B(){console.log("Homepage script initializing...");const o=document.getElementById("hero-bg-image"),e=document.getElementById("hero-products-container");document.getElementById("hero-title");const u=document.getElementById("hero-highlight-text"),l=document.getElementById("hero-description"),x=document.getElementById("hero-badge"),b=document.getElementById("hero-badge-text"),h=document.getElementById("hero-badge-icon"),v=document.getElementById("hero-shop-btn");if(!e){console.error("Hero products container not found! Check index.html IDs.");return}let f=s.default;const $=t=>{if(f.name===t.name)return;const n=(r,g,m)=>{r&&(r.classList.remove(g),Object.values(s).forEach(p=>{r.classList.remove(p.colors.primary,p.colors.bg,p.colors.light,p.colors.border)}),r.classList.add(m))};n(u,f.colors.primary,t.colors.primary),n(b,f.colors.primary,t.colors.primary),n(h,f.colors.primary,t.colors.primary),n(x,f.colors.light,t.colors.light),n(v,f.colors.bg,t.colors.bg),f=t},w=t=>{const n=t.images?.[0];n&&o&&(o.style.opacity="0",setTimeout(()=>{o.style.backgroundImage=`url('${n}')`,o.style.opacity="1"},300)),l&&(l.textContent=t.description||"Discover unique crochet patterns for makers and finished handmade goods for warmth seekers.");const r=document.getElementById("hero-floating-title"),g=document.getElementById("hero-floating-subtitle");r&&(r.textContent=t.name);const m=document.getElementById("hero-floating-icon");if(m){let c="stars";const i=t.name.toLowerCase();i.includes("bag")||i.includes("tote")?c="shopping_bag":i.includes("blanket")||i.includes("throw")?c="bed":i.includes("toy")||i.includes("doll")||i.includes("amigurumi")||i.includes("bunny")?c="smart_toy":i.includes("pattern")||i.includes("pdf")?c="description":(i.includes("scarf")||i.includes("shawl"))&&(c="checkroom"),m.textContent=c}g&&(g.textContent=t.categories?.name||"Best Seller"),v&&(v.href=`/pages/product.html?id=${t.id}`,v.textContent="Shop This Item");const p=M(t);$(p)};try{console.log("Fetching products...");const t=await C.getProducts();if(console.log("Products fetched:",t),t.length>0){const n=t.slice(0,3);let r=0,g;const m=()=>{p(),g=setInterval(()=>{r=(r+1)%n.length,w(n[r])},5e3)},p=()=>{g&&clearInterval(g)};w(t[0]),m(),e.innerHTML=n.map((c,i)=>{const y=c.images?.[0]||"";return y?`
                    <button class="hero-thumb-btn group relative size-24 rounded-2xl border-2 border-white dark:border-[#1e293b] shadow-lg overflow-hidden transition-transform duration-300 hover:scale-110 hover:z-10 bg-white dark:bg-[#0f172a] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary" 
                       data-index="${i}"
                       title="${c.name}">
                        <img src="${y}" alt="${c.name}" class="w-full h-full object-cover pointer-events-none">
                        <div class="absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors pointer-events-none"></div>
                    </button>
                `:""}).join(""),e.addEventListener("click",c=>{const i=c.target.closest(".hero-thumb-btn");if(i){const y=i.getAttribute("data-index");if(y){const I=parseInt(y),E=n[I];E&&(console.log("Hero update triggered for:",E.name),r=I,w(E),m())}}}),t.length>3&&(e.innerHTML+=`
                    <a href="/pages/shop.html" class="flex items-center justify-center size-16 rounded-full bg-gray-100 dark:bg-[#1e293b] text-gray-500 text-xs font-bold hover:bg-primary hover:text-white transition-colors ml-2">
                        +${t.length-3}
                    </a>
                `),setTimeout(()=>{e.classList.remove("opacity-0","translate-y-4")},100)}else console.log("No products found."),e.innerHTML='<div class="text-sm text-gray-500 px-4">No new arrivals.</div>',e.classList.remove("opacity-0","translate-y-4")}catch(t){console.error("Failed to load homepage products:",t),e.innerHTML='<div class="text-sm text-red-400 px-4">Error loading content.</div>',e.classList.remove("opacity-0","translate-y-4")}async function H(){const t=document.getElementById("trending-products-container");if(t)try{t.innerHTML='<div class="col-span-full text-center py-10 text-gray-400">Loading trending...</div>';const n=await C.getTrendingProducts();if(n.length===0){t.innerHTML='<div class="col-span-full text-center py-10 text-gray-400">No trending products yet.</div>';return}t.innerHTML=n.map(r=>{const g=r.images?.[0]||"",m=r.categories?.name||"Product";return`
                <div class="group flex flex-col gap-3">
                  <div class="relative w-full aspect-[4/5] rounded-xl overflow-hidden bg-gray-100 dark:bg-gray-800">
                    ${Date.now()-new Date(r.created_at).getTime()<10080*60*1e3?'<span class="absolute top-3 left-3 bg-green-100 text-green-700 px-3 py-1 rounded-full text-xs font-bold z-10">New</span>':'<span class="absolute top-3 left-3 bg-white/90 dark:bg-black/60 backdrop-blur-sm px-3 py-1 rounded-full text-xs font-bold z-10">Best Seller</span>'}
                    <button
                      class="absolute top-3 right-3 size-8 bg-white/50 hover:bg-white rounded-full flex items-center justify-center backdrop-blur-sm opacity-0 group-hover:opacity-100 transition-opacity z-10 text-primary">
                      <span class="material-symbols-outlined text-[18px]">favorite</span>
                    </button>
                    <a href="/pages/product.html?id=${r.id}" class="block w-full h-full">
                        <div class="w-full h-full bg-cover bg-center group-hover:scale-105 transition-transform duration-500"
                          style='background-image: url("${g}");'>
                        </div>
                    </a>
                    <div
                      class="absolute bottom-0 left-0 right-0 p-4 bg-gradient-to-t from-black/60 to-transparent opacity-0 group-hover:opacity-100 transition-opacity flex justify-center pb-6">
                      <a href="/pages/product.html?id=${r.id}"
                        class="bg-white text-black text-sm font-bold py-2 px-6 rounded-full hover:bg-gray-100 transform translate-y-4 group-hover:translate-y-0 transition-transform">
                        Quick View
                      </a>
                    </div>
                  </div>
                  <div class="flex flex-col gap-1">
                    <div class="flex justify-between items-start">
                      <a href="/pages/product.html?id=${r.id}" class="font-bold text-lg leading-tight group-hover:text-primary transition-colors cursor-pointer line-clamp-1">
                        ${r.name}
                      </a>
                      <span class="font-bold text-primary">â‚±${r.price.toFixed(2)}</span>
                    </div>
                    <p class="text-sm text-gray-500 dark:text-gray-400 capitalize">${m}</p>
                  </div>
                </div>
                `}).join("")}catch(n){console.error("Error loading trending products:",n),t.innerHTML='<div class="col-span-full text-center py-10 text-red-400">Unable to load trending products.</div>'}}H();const L=document.getElementById("newsletter-form"),k=document.getElementById("newsletter-email"),a=document.getElementById("newsletter-feedback"),d=document.getElementById("newsletter-submit-btn");L&&k&&d&&L.addEventListener("submit",async t=>{t.preventDefault();const n=k.value.trim();if(a&&(a.classList.add("hidden"),a.textContent="",a.classList.remove("text-green-600","text-red-500")),d.disabled=!0,d.textContent="Subscribing...",!T.validateEmail(n)){a&&(a.textContent="Please enter a valid email address.",a.classList.remove("hidden"),a.classList.add("text-red-500")),d.disabled=!1,d.textContent="Subscribe";return}const r=await T.subscribe(n);r.success?(a&&(a.textContent=r.message,a.classList.remove("hidden","text-red-500"),a.classList.add("text-green-600")),k.value="",d.textContent="Subscribed!",setTimeout(()=>{d.disabled=!1,d.textContent="Subscribe"},3e3)):(a&&(a.textContent=r.message,a.classList.remove("hidden","text-green-600"),a.classList.add("text-red-500")),d.disabled=!1,d.textContent="Subscribe")})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",B):B();
